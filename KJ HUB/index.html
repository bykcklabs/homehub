<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Our Little Life - HomeHub</title>
<style>
:root { --bg: #fdfaf7; --accent: #d4a373; --card-bg: #ffffff; --text: #4a4a4a; --radius: 35px; --shadow: 0 15px 35px rgba(0,0,0,0.07); --amt-fun: #27ae60; --urgent: #e67e22; --dark-ui: #34495e; --muted-sage: #95a5a6; --paid-green: #2ecc71; --label-gray: #a0a0a0; --border: #f0f0f0; } 
body.dark-mode { --bg: #121212; --card-bg: #1e1e1e; --text: #e0e0e0; --border: #333; --shadow: 0 15px 35px rgba(0,0,0,0.4); }
body.dark-mode nav, body.dark-mode .bubble, body.dark-mode .budget-list-container, body.dark-mode .grocery-list-container, body.dark-mode .modal-content { background: #1e1e1e; border-color: #333; color: var(--text); }
body.dark-mode input { color: var(--text) !important; }

* { margin: 0; padding: 0; box-sizing: border-box; } 
body { font-family: 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; } 

#loginOverlay { position: fixed; inset: 0; z-index: 9999; background: url('image1.jpg') center/cover no-repeat; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px); } 
.login-card { background: transparent; text-align: center; width: 320px; } 
.pin-display { background: transparent; height: 60px; margin-bottom: 40px; display: flex; align-items: center; justify-content: center; gap: 15px; color: white; font-size: 2.5rem; } 
.keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 25px; } 
.key { width: 70px; height: 70px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.8rem; cursor: pointer; border-radius: 50%; } 
.key:active { background: rgba(255,255,255,0.1); } 

nav { width: 250px; background: #fff; border-right: 1px solid #eee; padding: 40px 25px; display: none; flex-direction: column; gap: 12px; z-index: 100; }
.logo { font-weight: 800; font-size: 1.2rem; margin-bottom: 40px; color: var(--accent); text-align: center; letter-spacing: 1px; } 
nav a { text-decoration: none; color: #888; padding: 15px 20px; border-radius: 20px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 10px; } 
nav a.active { background: var(--accent) !important; color: white !important; } 

main { flex-grow: 1; padding: 40px 60px; overflow-y: auto; display: none; } 
.page { display: none; animation: fadeIn 0.4s ease; }
.page.active { display: block; } 

.home-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 30px; }
.weather-station { text-align: right; background: rgba(255,255,255,0.8); padding: 12px 25px; border-radius: 25px; display: flex; align-items: center; gap: 18px; cursor: pointer; box-shadow: var(--shadow); }

.carousel-container { width: 70%; max-width: 550px; height: 320px; background: #222; border-radius: var(--radius); margin: 0 auto 40px; overflow: hidden; border: 8px solid white; box-shadow: var(--shadow); } 
#carouselImg { width: 100%; height: 100%; object-fit: cover; transition: opacity 0.8s; } 

.bubble-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 220px)); gap: 20px; justify-content: center; } 
.bubble { background: #fff; padding: 40px 20px; border-radius: var(--radius); text-align: center; box-shadow: var(--shadow); cursor: pointer; }

.big-rem, .big-count { font-size: 4.5rem; font-weight: 900; text-align: center; margin-bottom: 25px; } 
.income-pill { background: #fff; padding: 15px 30px; border-radius: 50px; width: fit-content; margin: 0 auto 40px; box-shadow: var(--shadow); } 
.income-pill input { border: none; outline: none; font-weight: 800; color: var(--amt-fun); width: 150px; text-align: center; font-size: 1.5rem; background: transparent; } 

.budget-list-container, .grocery-list-container { background: white; border-radius: 20px; padding: 20px; box-shadow: var(--shadow); margin-bottom: 30px; } 
.bill-row, .g-item { display: grid; grid-template-columns: 2fr 1.5fr 0.8fr 1fr 40px; align-items: center; gap: 15px; padding: 15px 0; border-bottom: 1px solid var(--border); } 
.bill-row input, .g-item input { border: none; outline: none; background: transparent; font-weight: 800; width: 100%; color: var(--text); }

.cute-btn { background: var(--dark-ui); color: white; border: none; padding: 18px 40px; border-radius: 25px; font-weight: 800; cursor: pointer; width: 100%; }

#weatherDetailModal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.4); z-index: 10001; align-items: center; justify-content: center; backdrop-filter: blur(5px); } 
.modal-content { background: white; padding: 35px; border-radius: var(--radius); width: 90%; max-width: 500px; text-align: center; }

@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>

<div id="loginOverlay"> 
    <div class="login-card"> 
        <h2 style="color:white; margin-bottom:20px;">PIN</h2> 
        <div class="pin-display" id="pinDots"></div> 
        <div class="keypad"> 
            <div class="key" onclick="press(1)">1</div><div class="key" onclick="press(2)">2</div><div class="key" onclick="press(3)">3</div> 
            <div class="key" onclick="press(4)">4</div><div class="key" onclick="press(5)">5</div><div class="key" onclick="press(6)">6</div>
            <div class="key" onclick="press(7)">7</div><div class="key" onclick="press(8)">8</div><div class="key" onclick="press(9)">9</div> 
            <div class="key" onclick="resetPin()">C</div><div class="key" onclick="press(0)">0</div><div class="key" onclick="press('X')">‚å´</div> 
        </div> 
    </div> 
</div> 

<nav id="sidebarNav"> 
    <div class="logo">OUR LITTLE LIFE</div> 
    <a onclick="showPage('home')" id="link-home" class="active">üè† Home</a> 
    <a onclick="showPage('budget')" id="link-budget">üí∞ Budget</a> 
    <a onclick="showPage('grocery')" id="link-grocery">üõí Grocery</a> 
</nav> 

<main id="mainContent"> 
    <div id="home" class="page active" style="padding-top: 10vh;"> 
        <div class="home-header">
            <div>
                <h1 id="greetUser" class="greet-text">Hello</h1>
                <div id="liveClock" class="date-time"></div>
            </div>
            <div class="weather-station" onclick="openWeatherDetails()">
                <span id="wIcon" class="weather-icon">‚òÄÔ∏è</span>
                <div><span id="wTemp" class="weather-temp">--¬∞</span><br><small>Twin Falls</small></div>
            </div>
        </div>
        <div class="carousel-container"><img id="carouselImg" src="image1.jpg"></div> 
        <div class="bubble-grid"> 
            <div class="bubble" onclick="showPage('budget')"><h3>Budget</h3><p id="home-rem-val">$0 Left</p></div> 
            <div class="bubble" onclick="showPage('grocery')"><h3>Grocery</h3><p id="home-g-count">0 Items</p></div> 
        </div> 
    </div>

    <div id="budget" class="page">
        <h2 style="text-align:center;">Budget</h2>
        <div class="big-rem" id="remDisplay">$0.00</div>
        <div class="income-pill"><input type="number" id="incInput" oninput="saveB()"></div>
        <div class="budget-list-container"><div id="billStack"></div><button class="cute-btn" onclick="addBillRow()">+ Add Expense</button></div>
    </div>

    <div id="grocery" class="page">
        <h2 style="text-align:center;">Grocery</h2>
        <div class="big-count" id="gCountDisplay">0</div>
        <div class="grocery-list-container"><div id="gStack"></div><button class="cute-btn" onclick="addGRow()">+ Add Item</button></div>
    </div>
</main>

<div id="weatherDetailModal" onclick="this.style.display='none'">
    <div class="modal-content"><h2 id="detDescription">--</h2><p id="detForecast" style="margin:20px 0;"></p><button class="cute-btn">Close</button></div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDdOVEcFxPCI8dQOO6Z6Vv_81fk42-kBWE",
  authDomain: "homehub-37637.firebaseapp.com",
  projectId: "homehub-37637",
  storageBucket: "homehub-37637.firebasestorage.app",
  messagingSenderId: "34718529064",
  appId: "1:34718529064:web:5c22134b44dadcc040a71d"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let pin = ""; let currentUser = ""; let weatherDetails = { desc: "", forecast: "" };
let photos = ['image1.jpg', 'image2.jpg', 'image3.jpg']; let currentIdx = 0;

function press(n) { 
    if(n === 'X') pin = pin.slice(0,-1); else pin += n;
    document.getElementById('pinDots').innerText = "‚Ä¢".repeat(pin.length);
    if(pin === "466464") unlock("Kyron"); if(pin === "890555") unlock("Jake");
}
function resetPin() { pin = ""; document.getElementById('pinDots').innerText = ""; }
function unlock(user) {
    currentUser = user;
    document.getElementById('loginOverlay').style.display = 'none';
    document.getElementById('sidebarNav').style.display = 'flex';
    document.getElementById('mainContent').style.display = 'block';
    document.getElementById('greetUser').innerText = "Welcome, " + user + "!";
    fetchWeather(); updateClock(); setInterval(updateClock, 1000);
    setInterval(() => { currentIdx = (currentIdx + 1) % photos.length; document.getElementById('carouselImg').src = photos[currentIdx]; }, 5000);
}

function showPage(p) { document.querySelectorAll('.page').forEach(pg => pg.classList.remove('active')); document.getElementById(p).classList.add('active'); }

function addBillRow(n="", d="", v="", p=false, sync=true) {
    const row = document.createElement('div'); row.className = 'bill-row';
    row.innerHTML = `<input type="text" class="name" value="${n}" oninput="saveB()"><input type="date" class="date" value="${d}" oninput="saveB()"><input type="checkbox" class="paid-chk" ${p ? 'checked' : ''} onchange="saveB()"><input type="number" class="val" value="${v}" oninput="saveB()"><span onclick="this.parentElement.remove(); saveB();">‚úï</span>`;
    document.getElementById('billStack').appendChild(row); if(sync) runMath();
}

function saveB() {
    let rows = []; document.querySelectorAll('.bill-row').forEach(r => rows.push({ n: r.querySelector('.name').value, d: r.querySelector('.date').value, v: r.querySelector('.val').value, p: r.querySelector('.paid-chk').checked }));
    db.collection("data").doc("budget").set({ inc: document.getElementById('incInput').value, rows }); runMath();
}

function addGRow(n="", c=false, sync=true) {
    const row = document.createElement('div'); row.className = 'g-item';
    row.innerHTML = `<input type="checkbox" ${c ? 'checked' : ''} onchange="saveG()"><input type="text" value="${n}" oninput="saveG()"><span onclick="this.parentElement.remove(); saveG();">‚úï</span>`;
    document.getElementById('gStack').appendChild(row); if(sync) saveG();
}

function saveG() {
    let items = []; document.querySelectorAll('.g-item').forEach(r => items.push({ n: r.querySelector('input[type="text"]').value, c: r.querySelector('input[type="checkbox"]').checked }));
    db.collection("data").doc("grocery").set({ items });
    let active = items.filter(i => !i.c).length;
    document.getElementById('gCountDisplay').innerText = active;
    document.getElementById('home-g-count').innerText = active + " Items";
}

function runMath() {
    let inc = parseFloat(document.getElementById('incInput').value) || 0;
    let total = 0; document.querySelectorAll('.bill-row').forEach(r => total += parseFloat(r.querySelector('.val').value) || 0);
    document.getElementById('remDisplay').innerText = "$" + (inc - total).toFixed(2);
    document.getElementById('home-rem-val').innerText = "$" + Math.round(inc - total) + " Left";
}

db.collection("data").doc("budget").onSnapshot(doc => { if(doc.exists) { const d = doc.data(); document.getElementById('incInput').value = d.inc || 0; document.getElementById('billStack').innerHTML = ""; d.rows?.forEach(r => addBillRow(r.n, r.d, r.v, r.p, false)); runMath(); } });
db.collection("data").doc("grocery").onSnapshot(doc => { if(doc.exists) { const d = doc.data(); document.getElementById('gStack').innerHTML = ""; d.items?.forEach(i => addGRow(i.n, i.c, false)); saveG(); } });

async function fetchWeather() {
    try {
        const resp = await fetch('https://api.weather.gov/stations/KTWF/observations/latest');
        const data = await resp.json();
        document.getElementById('wTemp').innerText = Math.round((data.properties.temperature.value * 9/5) + 32) + "¬∞";
        weatherDetails.desc = data.properties.textDescription;
        const fResp = await fetch('https://api.weather.gov/gridpoints/BOI/145,51/forecast');
        const fData = await fResp.json();
        weatherDetails.forecast = fData.properties.periods[0].detailedForecast;
    } catch(e) {}
}

function openWeatherDetails() {
    document.getElementById('detDescription').innerText = weatherDetails.desc;
    document.getElementById('detForecast').innerText = weatherDetails.forecast;
    document.getElementById('weatherDetailModal').style.display = 'flex';
}
function updateClock() { document.getElementById('liveClock').innerText = new Date().toLocaleTimeString(); }
window.addEventListener('keydown', (e) => { if (e.key >= '0' && e.key <= '9') press(e.key); if(e.key === 'Backspace') press('X'); });
</script> 
</body> 
</html>